---
layout: project
title: Position Tracker
date: August 2015
image: http://i1380.photobucket.com/albums/ah164/aturchina0528/portfolio/harddrive_zpsigoffddt.jpg
---

## Overview

This project is a proof of concept finger position tracker to be used with a touchscreen that gives haptic feedback. Haptic feedback is the use of advanced vibration patterns and waveforms to convey information to a user or operator. Traditional methods of finger tracking with touchscreens face challenges of reliability and accuracy when implementing haptic feedback. This project explores bringing a mixture of technologies together to overcome these obstacles.  

There were many design considerations in what technologies would be accurate, fast, reliable, and scalable. The current prototype uses a voice coil from a computer, a laser and mirror, a hall effect sensor and magnet, a solar cell, and a PIC32 microcontroller. The voicecoil has a mirror and magnet mounted on top of it, with a hall effect sensor over top to act as the feedback on the position, as pictured below.

**_Click_** on the image below for a demonstration!  
[![Picture](http://i1380.photobucket.com/albums/ah164/aturchina0528/portfolio/drawing_zpsmlprmrip.png)](https://vimeo.com/137771616)


 The laser hits the mirror and is redirected at a solar cell which outputs a signal that is processed to determine whether the laser is hitting a finger or not based on the solar cell output.  

![solarfinal](http://i1380.photobucket.com/albums/ah164/aturchina0528/portfolio/solarsetup_zpsnxuua7h6.jpg)


### Project outline
The main components of the project were broken down into five parts:  

* Controlling the voice coil  
* Implementing the hall effect sensor  
* Converting sensor data to position  
* Implementing the solar cell  
* Designing the controls  

### Step by step
* Controlling the voice coil  
  * I disassembled an old computer hard drive to gain access to the voice coil inside. The theory behind a voice coil is a coil inside a magnetic field. Depending on the current direction on the coil, the arm moves to one side or the other. And depending on the intensity of the current, the speed will be faster or slower. I used an H-Bridge to control the current direction on the coil and pulse width modulation (PWM) to control the speed, as the microcontroller isn't capable of variable analog output.

![hbridge](http://i1380.photobucket.com/albums/ah164/aturchina0528/portfolio/picsnap_zpsje0na8as.jpg)

* Implementing the hall effect sensor  
  * Once I was able to control the direction and speed of the voice coil, the next step was to accurately determine the position of the voice coil. I mounted a magnet and hall effect sensor above the voice coil. When a hall effect sensor is subjected to a magnetic field, it responds with an output voltage proportional to the magnetic field strength. In this application, the sensor is in a fixed position while the magnet is fixed to the voice coil and rotates.  

  *  The microcontroller has an analog-to-digital converter (ADC) that can sample an analog input (hall effect sensor) with 10-bits of resolution, or 1024 different voltage values over 0-3.3 volts. The hall effect output was connected to the microcontroller ADC to assign a value to the position. However, since the hall effect output range was only ~1V, in order to utilize a larger portion of the 0-3.3V, or 1024 bits of resolution, I used an op-amp to amplify the signal. Having better resolution allows for better position accuracy of the voice coil.  

* Converting sensor data to position  
  * After being able to control the voice coil and its position, a prototype of a grid was made to help calibrate the conversion of hall effect output to real world coordinates. Several tests were run to accurately gather the hall effect reading at both edges of the sensing area. The sensing area is a known value, so we can calculate the the inches per bit of resolution to determine our accuracy.  

* Implementing the solar cell  
  * Solar cells rely on the photoelectric effect, the ability of matter to emit electrons when a light is shone on it. In this application, I measured the output voltage from the solar cell. When shining a light or laser at the solar cell, there is a rise in the output voltage compared to without. The microcontroller being used has limitations on the current and voltage it can handle. In order to keep the current within range, solar cells were connected in series. In series, voltage is additive and current is constant. Since voltage is additive, the solar cell output would be too high for the microcontroller.  

![solarnew](http://i1380.photobucket.com/albums/ah164/aturchina0528/portfolio/solarorig_zpsir13c1vv.jpg)

In order to reduce the output voltage further, the amount of exposed area of the solar cell was reduced to focus on where the laser would hit. In addition to limiting the exposed area, a filter film was applied to eliminate light outside of the red spectrum which is the color of the laser.  

![solarfilter](http://i1380.photobucket.com/albums/ah164/aturchina0528/portfolio/solarfinal_zpss5qaocni.jpg)

The next step is to create a housing to reduce some of the ambient light sources. It was determined that a light diffuser would improve performance of the solar cell output as it only needs to detect a new light source. And lastly, a diode was used as protection to ensure the maximum voltage was not exceeded.  

![diffuser](http://i1380.photobucket.com/albums/ah164/aturchina0528/portfolio/solarsetup_zpsnxuua7h6.jpg)

* Designing the controls  
  * Everything is now set up to implement the controls and feedback! 


### Component information
Microcontrollers: 
H-Bridge: 
Hall effect sensors: 
Op amps: 
Diodes: 


### Further resources
PIC32
PWM
ADC

